<!-- Leave Requests Modal -->
<div class="modal fade" id="leaveRequestsModal" tabindex="-1" aria-labelledby="leaveRequestsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable modal-fullscreen-sm-down">

      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="leaveRequestsModalLabel">Leave Requests</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="leaveRequestsSpinner" class="text-center my-3">
            <div class="spinner-border text-primary" role="status"></div>
          </div>
          <table class="table table-striped d-none" id="leaveRequestsTable">
            <thead>
              <tr>
                <th>Army Number</th>
                <th>Leave Type</th>
                <th>Days</th>
                <!-- <th>Status</th> -->
                <!-- <th>Remarks</th> -->
                <!-- <th>Applied At</th> -->
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="leaveRequestsTableBody"></tbody>
          </table>
          
        </div>
      </div>
    </div>
  </div>

  <script>
    document.getElementById("leaveRequestsBtn")?.addEventListener("click", async () => {
      const modal = new bootstrap.Modal(document.getElementById("leaveRequestsModal"));
      modal.show();
      await loadLeaveRequests();
    });
    
    async function loadLeaveRequests() {
      const spinner = document.getElementById("leaveRequestsSpinner");
      const table = document.getElementById("leaveRequestsTable");
      const tbody = document.getElementById("leaveRequestsTableBody");
    
      spinner.classList.remove("d-none");
      table.classList.add("d-none");
      tbody.innerHTML = "";
    
      try {
        const res = await fetch("/apply_leave/get_leave_requests");
        const result = await res.json();
    
        result.data.forEach(row => {
    
          
    
          let actions = `
          <button class="btn btn-primary btn-sm"
            onclick="viewLeaveRequest(${row.id})">
            View
          </button>
        `;
    
          tbody.innerHTML += `
            <tr>
              <td>${row.army_number}</td>
              <td>${row.leave_type}</td>
              <td>${row.leave_days}</td>
              <td>${actions}</td>
            </tr>
          `;
        });
    
        spinner.classList.add("d-none");
        table.classList.remove("d-none");
    
      } catch (err) {
        console.error(err);
        spinner.innerHTML = `<p class="text-danger fw-bold mt-3">Failed to load leave requests</p>`;
      }
    }
    </script>
    
  
{% extends "baseView.html" %}
{% block content %}
  <div style="padding-left: 16rem;">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h3>{{ store.store_name }} <small class="text-muted">#{{ store.storeId }}</small></h3>
        <div class="text-muted">{{ store.place or '-' }} â€” Incharge: {{ store.store_incharge or '-' }}</div>
      </div>
      <div>
        <a class="btn btn-outline-secondary" href="{{ url_for('stores_dashboard') }}">Back to Stores</a>
        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addItemModal">Add Item</button>
      </div>
    </div>
  
    <!-- Items table -->
    <div class="card p-3 mb-4">
      <div class="table-responsive">
        <table class="table table-bordered table-sm">
          <thead>
            <tr>
              <th>#</th>
              <th>QLPNO</th>
              <th>SLPNO</th>
              <th>Nomenclature</th>
              <th>A/U</th>
              <th>Quantity</th>
              <th>Added</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% for it in items %}
            <tr>
              <td>{{ it.itemId }}</td>
              <td>{{ it.QLPNO or '-' }}</td>
              <td>{{ it.SLPNO or '-' }}</td>
              <td>{{ it.NOMENCLATURE }}</td>
              <td>{{ it.AU or '-' }}</td>
              <td>{{ it.Quantity }}</td>
              <td>
                <form method="post" action="{{ url_for('delete_item', store_id=store.store_id, item_id=it.item_id) }}" style="display:inline">
                  <button class="btn btn-sm btn-danger" onclick="return confirm('Delete this item?')">Delete</button>
                </form>
              </td>
            </tr>
            {% else %}
            <tr><td colspan="8">No items in this store yet.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

  </div>

  <!-- Add Item Modal -->
  <div class="modal fade" id="addItemModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <form method="post" action="{{ url_for('add_item', store_id=store.store_id) }}">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add Item to {{ store.store_name }}</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">QLP No.</label>
              <input name="QLPNO" class="form-control">
            </div>
            <div class="mb-3">
              <label class="form-label">SLP No.</label>
              <input name="SLPNO" class="form-control">
            </div>
            <div class="mb-3">
              <label class="form-label">Nomenclature *</label>
              <input name="NOMENCLATURE" class="form-control" required>
            </div>
            <div class="mb-3">
              <label class="form-label">A / U (Nos / mts / kg)</label>
              <input name="AU" class="form-control">
            </div>
            <div class="mb-3">
              <label class="form-label">Quantity</label>
              <input name="Quantity" class="form-control" value="0">
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button class="btn btn-primary" type="submit">Add Item</button>
          </div>
        </div>
      </form>
    </div>
  </div>

{% endblock %}

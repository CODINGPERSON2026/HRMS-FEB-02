{% extends "baseView.html" %}
{% block content %}
  <div class="store-container" style="padding-left: 16rem;">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h3>Stores Dashboard</h3>
        <!-- Button trigger Add Store modal -->
        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addStoreModal">Add Store</button>
      </div>
    
      <!-- Stores table -->
      <div class="card p-3">
        <div class="table-responsive">
          <table class="table table-hover">
            <thead>
              <tr>
                <th>Store ID</th>
                <th>Store Name</th>
                <th>Place</th>
                <th>Incharge</th>
                <th>Total Items</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for s in stores %}
              <tr>
                <td>{{ s.store_id }}</td>
                <td>{{ s.store_name }}</td>
                <td>{{ s.place or '-' }}</td>
                <td>{{ s.incharge_name or '-' }}</td>
                <td>{{ s.total_items }}</td>
                <td>
                  <a class="btn btn-sm btn-outline-primary" href="{{ url_for('view_store', store_id=s.store_id) }}">View</a>
                  <form action="{{ url_for('delete_store', store_id=s.store_id) }}" method="POST" style="display:inline;">
                        <button class="btn btn-danger btn-sm"
                                onclick="return confirm('Are you sure you want to delete this store? All items inside it will be removed.');">
                            Delete
                        </button>
                  </form>
                 </td>
              </tr>
              {% else %}
              <tr><td colspan="7">No stores yet. Add one using the button above.</td></tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
  </div>

  <!-- Add Store Modal -->
  <div class="modal fade" id="addStoreModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <form method="post" action="{{ url_for('add_store') }}">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add Store</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Store Name</label>
              <input name="store_name" class="form-control" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Place</label>
              <input name="place" class="form-control">
            </div>
            <div class="mb-3">
              <label class="form-label">Store Incharge</label>
              <input name="store_incharge" class="form-control">
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button class="btn btn-primary" type="submit">Create Store</button>
          </div>
        </div>
      </form>
    </div>
  </div>
{% endblock %}
